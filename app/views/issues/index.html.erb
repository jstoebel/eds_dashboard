<%= link_to students_path, class: "btn btn-default back-link glyphicon glyphicon-arrow-left" do %>
  <i class=" link-text"> Back</i>
<% end %>

    </br>

          <table class="table table-striped">
            <caption>
              <div class="header1">Issues for <%= "#{@first_name} #{@last_name}"%></div>
            </caption>

            <% if @student.issues.size > 0 %>

              <tr class="header">
                <th>Issue Name</th>
                <th>Date Opened</th>
                <th>Status</th>
              </tr>

              <% @student.issues.sorted.each do |issue| %>

              <tr>
                <td> <%= issue.Name %></td>
                <td> <%= issue.CreateDate.strftime("%m/%d/%Y")%> </td>

                <td class="<%= issue.Open ? "bad_text" : "good_text" %>">
                  <!-- glyh here if open -->
                  <% if issue.Open %>

                      <div class="col-md-1">
                        <span class="glyphicon glyphicon-exclamation-sign"></span>
                      </div>

                      <div class="col-md-1">
                        Open
                      </div>

                  <% else %>
                      <div class="col-md-1">
                        <span class="glyphicon glyphicon-ok"></span>
                      </div>

                      <div class="col-md-1">
                        Resolved
                      </div>
                  <% end #end of status conditional %>

                </td>

                <td class="actions">
                  <!-- buttons
                    details
                    updates
                    close isue -->


               
                    <%= link_to "Details", issue_path(issue.IssueID), class: "btn btn-info action-small"%>
                              
                    <%= link_to "Updates", issue_issue_updates_path(issue.IssueID), class: "btn btn-info action-small"%>   
                              
                    <%= link_to "Resolve Issue", issue_issue_updates_path(issue.IssueID), class: "btn btn-info action-small"%>                             
                      
                </td>
              </tr>
              <% end #end of loop iterating through records %>              

            <% end #end of conditional for table. %>       

          </table>

          <table summary="Student detail view">
            <caption>

              <h2>Issues for <%= "#{@first_name} #{@last_name}"%></h2>
              <%= link_to(image_tag('plus_sign.png', :size => '11x11', :alt => '+') + " Open New Issue", new_student_issue_path(@student.AltID), :class => 'large_action issue_new new') %>
              <div class="issue_header"> <%= pluralize(@student.issues.size, 'issue') %>  found

              </div>
            </caption>
    <% if @student.issues.size > 0 %>

        <% @student.issues.sorted.each do |issue| %>
            <tr>
              <th>Issue Name</th>
              <td><%= issue.Name %></td>
            </tr>

            <tr>
              <th>Status</th>
              <td class="<%= issue.Open ? "bad_text" : "good_text" %>"><%= issue.Open ? "open" : "closed" %>
              </td>
            </tr>

            <tr>
              <th>Date Opened</th>
              <td><%= issue.CreateDate.strftime("%m/%d/%Y")%> </td>

            </tr>
            <!-- Action buttons if issue is open -->
            <% if issue.Open %>   
            <tr>
              <th></th>

              <td><%= link_to("Add an update", new_issue_issue_update_path(issue.IssueID), :class => 'action new') %> 

                  <%= link_to("Close issue", issue_resolve_issue_path(issue.IssueID), :class => "action edit") %>
            <% end %>
              </td>

            </tr>
          </table>

          <div class="issue_discrip">
            <%=issue.Description%>
          </div>

            <!-- updates go here! -->
            <% if issue.issue_updates.sorted.size > 0 %>

              <% issue.issue_updates.sorted.each do |update| %> 

                <div class="issue_updates">
                <ul>                
                <strong><li><%= [update.CreateDate.strftime("%m/%d/%Y"), update.UpdateName].join(" ") %></li></strong>
                <%= update.Description %>
                </p>
                </ul></div>
                <% end %>


            <% end %>
            <hr>

        <% end %>

    <% end %>

</div>